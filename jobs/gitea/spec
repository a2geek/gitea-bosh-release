---
name: gitea

templates:
  bpm.yml.erb: config/bpm.yml
  env.sh.erb: config/env.sh
  create-admin-user.erb: bin/create-admin-user
  start.erb: bin/start
  app.ini.erb: config/app.ini
  public.pem.erb: config/certs/public.pem
  private.pem.erb: config/certs/private.pem
  aliases.json.erb: dns/aliases.json

packages:
- gitea

# Many of these properties are named after the Gitea configuration itself.
# See: https://docs.gitea.com/administration/config-cheat-sheet
properties:
  admin.username:
    description: "Name of the first administrator account."
  admin.email:
    description: "Email for the first administrator account."

  https.certificate:
    description: "HTTPS public certificate (PEM format) to use. Default is self-signed, generated by bosh."
  https.private_key:
    description: "HTTPS private key (PEM format) to use. Default is self-signed, generated by bosh."
  
  server.domain:
    description: "Domain name of this server."

  security.secret_key:
    description: "Global secret key. This key is VERY IMPORTANT, if you lost it, the data encrypted by it (like 2FA secret) can't be decrypted anymore."
  security.internal_token:
    description: "Secret used to validate communication within Gitea binary."

  oauth2.jwt_secret:
    description: "OAuth2 authentication secret for access and refresh tokens, change this to a unique string."

  database.type:
    description: "The database type in use [postgres, sqlite3]."
    default: "sqlite3"
  database.host:
    description: "Database host address and port or absolute path for unix socket."
    default: ""
  database.name:
    description: "Database name."
    default: "gitea"
  database.user:
    description: "Database username."
    default: ""
  database.password:
    description: "Database user password."
    default: ""
  database.schema: 
    description: 'For PostgreSQL only, schema to use if different from "public". The schema must exist beforehand, the user must have creation privileges on it, and the user search path must be set to the look into the schema first (e.g. ALTER USER user SET SEARCH_PATH = schema_name,"$user",public;).'
    default: "public"
  database.tls:
    description: "SSL/TLS encryption mode for connecting to the database. This option is only applied for PostgreSQL and MySQL."
    default: "disable"

  # Temporary hack?
  registration.username:
    description: "Username for registering the action runner."
    default: "act_runner"
  registration.password:
    description: "Password for registering the action runner."
